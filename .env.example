# Xkorin School Environment Variables - SECURITY CONFIGURED + OAuth
# Copy this file to .env and fill in your actual values
# NEVER commit .env to git!

# ====================
# DATABASE
# ====================
DATABASE_URL="mongodb+srv://username:password@cluster.mongodb.net/Xkorin School?retryWrites=true&w=majority"

# ====================
# AUTHENTICATION & SECURITY
# ====================
# Base URL of your application
NEXTAUTH_URL="http://localhost:3000"
# In production: NEXTAUTH_URL="https://your-domain.com"

# CRITICAL: Generate a strong, unique secret with: openssl rand -base64 32
# This secret is used for JWT signing and CSRF protection
# NEVER use the example value below in production!
NEXTAUTH_SECRET="your-secret-here-CHANGE-THIS-IN-PRODUCTION"

# ====================
# OAUTH PROVIDERS (Optional)
# ====================
# Leave empty to disable specific providers
# The app will automatically enable/disable providers based on these variables

# Google OAuth
# Get credentials from: https://console.cloud.google.com/apis/credentials
# 1. Create a new OAuth 2.0 Client ID
# 2. Authorized redirect URIs: http://localhost:3000/api/auth/callback/google
#    (In production: https://your-domain.com/api/auth/callback/google)
GOOGLE_CLIENT_ID="your-google-client-id.apps.googleusercontent.com"
GOOGLE_CLIENT_SECRET="your-google-client-secret"

# GitHub OAuth (Optional)
# Get credentials from: https://github.com/settings/developers
# 1. Create a new OAuth App
# 2. Authorization callback URL: http://localhost:3000/api/auth/callback/github
#    (In production: https://your-domain.com/api/auth/callback/github)
GITHUB_CLIENT_ID="your-github-client-id"
GITHUB_CLIENT_SECRET="your-github-client-secret"

# Facebook OAuth (Future - not yet implemented)
# FACEBOOK_CLIENT_ID="your-facebook-app-id"
# FACEBOOK_CLIENT_SECRET="your-facebook-app-secret"

# Microsoft OAuth (Future - not yet implemented)
# MICROSOFT_CLIENT_ID="your-microsoft-client-id"
# MICROSOFT_CLIENT_SECRET="your-microsoft-client-secret"

# ====================
# REAL-TIME MESSAGING (Optional)
# ====================
# Ably is used for real-time chat and notifications
# Get your API key from: https://ably.com/accounts/any/apps/any/app_keys
# Leave empty to disable real-time features (polling will be used instead)
#
# SETUP INSTRUCTIONS:
# 1. Sign up at https://ably.com (free tier available)
# 2. Create a new app in your dashboard
# 3. Go to "API Keys" tab
# 4. Copy the "Root API Key" (format: appId.keyId:secret)
# 5. Paste it below
#
# Example format: abc123.def456:ghi789jkl012mno345
ABLY_API_KEY="your-ably-api-key"

# ====================
# ENVIRONMENT
# ====================
NODE_ENV="development"
# In production: NODE_ENV="production"

# ====================
# SETUP INSTRUCTIONS
# ====================
#
# GOOGLE OAUTH SETUP:
# 1. Go to https://console.cloud.google.com/apis/credentials
# 2. Create a new project or select existing one
# 3. Enable Google+ API
# 4. Create OAuth 2.0 Client ID:
#    - Application type: Web application
#    - Authorized redirect URIs:
#      * http://localhost:3000/api/auth/callback/google (development)
#      * https://your-domain.com/api/auth/callback/google (production)
# 5. Copy Client ID and Client Secret to this file
#
# GITHUB OAUTH SETUP:
# 1. Go to https://github.com/settings/developers
# 2. Click "New OAuth App"
# 3. Fill in:
#    - Application name: Xkorin School
#    - Homepage URL: http://localhost:3000
#    - Authorization callback URL: http://localhost:3000/api/auth/callback/github
# 4. Copy Client ID and Client Secret to this file
#
# ====================
# APPLICATION URL
# ====================
# Public URL for generating links (invitations, etc.)
NEXT_PUBLIC_APP_URL="http://localhost:3000"
# In production: NEXT_PUBLIC_APP_URL="https://your-domain.com"

# ====================
# MODULAR ARCHITECTURE & EVENT BUS
# ====================
# Enable/disable the new modular architecture with event-driven system
# Set to "true" to use the new system, "false" to use legacy monolithic architecture

# Use the new EventBus with priority queues and event sourcing
# false: Use only the old EventPublisher
# true: Use the new EventBus (recommended for new deployments)
USE_NEW_EVENT_BUS="false"

# Use the modular structure
# false: Legacy monolithic architecture
# true: New modular architecture with 8 business modules
USE_MODULAR_STRUCTURE="false"

# Event publishing mode during transition
# "dual": Publish to both old AND new systems (safest, slower performance)
# "new-only": Publish only to new EventBus (best performance, requires all modules migrated)
# "legacy-only": Publish only to old EventPublisher (no migration)
EVENT_PUBLISHING_MODE="dual"

# ====================
# MODULE ENABLEMENT (Progressive Migration)
# ====================
# Enable modules one by one as they are migrated and tested
# Only applies when USE_MODULAR_STRUCTURE="true"

MODULE_AUTH_ENABLED="false"
MODULE_ACADEMIC_STRUCTURE_ENABLED="false"
MODULE_INVITATIONS_ENABLED="false"
MODULE_ASSESSMENTS_ENABLED="false"
MODULE_EXAM_EXECUTION_ENABLED="false"
MODULE_GAMIFICATION_ENABLED="false"
MODULE_ANALYTICS_ENABLED="false"
MODULE_MESSAGING_ENABLED="false"

# ====================
# EVENT BUS CONFIGURATION
# ====================
# Fine-tune the event bus behavior

# Enable Dead Letter Queue for automatic retry of failed events
# true: Failed events are retried automatically (recommended)
# false: Failed events are logged but not retried
ENABLE_DEAD_LETTER_QUEUE="true"

# Enable Event Sourcing (store all events in MongoDB)
# true: All events are persisted for audit trail and replay (recommended)
# false: Events are processed in-memory only
ENABLE_EVENT_SOURCING="true"

# Maximum retry attempts for failed events (Dead Letter Queue)
# Default: 3
DLQ_MAX_RETRIES="3"

# Retry interval in milliseconds (5 minutes = 300000ms)
# Default: 300000 (5 minutes)
DLQ_RETRY_INTERVAL="300000"

# Event queue processing interval in milliseconds
# How often the EventBus processes queued events
# Default: 100ms
# Lower = more responsive, higher CPU usage
# Higher = less responsive, lower CPU usage
EVENT_QUEUE_PROCESSING_INTERVAL="100"

# Event Store TTL (Time To Live) in days
# How long events are kept in MongoDB before automatic cleanup
# Default: 90 days
EVENT_STORE_TTL_DAYS="90"

# Enable verbose event logging for debugging
# true: Log all events and handlers (use for development/debugging)
# false: Log only errors and warnings (use for production)
VERBOSE_EVENT_LOGGING="false"

# ====================
# SECURITY NOTES
# ====================
# 1. Generate NEXTAUTH_SECRET: openssl rand -base64 32
# 2. Use strong MongoDB credentials
# 3. Enable HTTPS in production
# 4. Keep this file out of version control (.gitignore)
# 5. Rotate secrets regularly
# 6. Use environment-specific configurations
# 7. OAuth secrets are sensitive - protect them like passwords
# 8. Configure OAuth redirect URIs correctly for each environment
